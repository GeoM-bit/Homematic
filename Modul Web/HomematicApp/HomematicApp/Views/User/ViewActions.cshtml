@model HomematicApp.ViewModels.ActionListModel

@{
    ViewData["Title"] = "View Actions";
	ViewData["action-type"] = "Action Type";
	ViewData["value"] = "Value";
	ViewData["date-time"] = "Date";
}
 
<h1>View Actions</h1>

<div class="card shadow mb-4">
	<div class="card-body">
		<div class="table-responsive">
			<table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
				<thead>
					<tr>
						<th class="text-center">@ViewData["action-type"]</th>
						<th class="text-center">@ViewData["value"]</th>
						<th class="text-center">@ViewData["date-time"]</th>
					</tr>
				</thead>
				<tbody>
					@foreach (var item in Model.Actions)
					{
						<tr>
							<td class="text-center">@item.Action_Type</td>
							<td class ="text-center">@item.Value_Action</td>
							<td class="text-center">@item.Date_Time</td>
						</tr>
					}
				</tbody>
			</table>
		</div>
	</div>
</div>
<div class="row">
	<div class="col-1">
		<label><b>Chart-Type</b></label>
		</div>
	<div class="col-2">
		<select id="ChartType" class="form-control" style="width:150px">
			<option selected>--Select Chart Type--</option>
			<option>bar</option>
			<option>line</option>
			<option>pie</option>
			<option>doughnut</option>
		</select>
	</div>
	<div class="col-4">
		<input id="ID" value="Temperature Graph" type="button" />
	</div>
</div>

<div id="ChartView">
	<canvas id="myChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="~/lib/jquery/dist/jquery.min.js"></script>

<script type="text/javascript">
	$(function () {
		$("#ID").click(function(){
			var chartType=$("#ChartType").val();
			var chartView = document.getElementById('ChartView');
			chartView.innerHTML='$nbsp';

			$('#ChartView').append('<canvas id="myChart" style="max-width:450px;max-height:400px"></canvas>');
			$.ajax({
				type:"POST",
				url:"/User/GetTemperature",
				data:"",
				contentType:"application/json; charset=utf-8",
				dataType:"json",
				success: OnSuccessResult,
				error: OnError
			});
			function OnSuccessResult(data){
				var _data = data;
				var _chartLabels = data[0];
				var _chartData = _data[1];

				new Chart("myChart",
				{
					type:chartType,
					data:{
						labels: _chartLabels,
						datasets: [{
							data: _chartData
						}]
					}
				});
			}
			function OnError(err) {

			}
		});
	});
</script>